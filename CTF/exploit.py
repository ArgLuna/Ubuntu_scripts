#!/usr/bin/python2

from pwn import *

def wait(isLocal = True, msg = 'pause', stime = 0.2):
	if isLocal == True:
		raw_input(msg)
	else:
		time.sleep(stime)

def padto64(string,  char = '\x00'):
	string += char * (8 - len(s))
	return string

def padtoN(string, size, char = '\x00'):
	return string.ljust(size, char)

local = True
#local = False
enable_gdb = False
elf = ''
host = 'ctf.adl.csie.ncu.edu.tw'
port = 10135

# plt & got

# main

# rop gadgets

# lib offsets

# code offsets

# plt, got
got = 0     # <_GLOBAL_OFFSET_TABLE_> offset

# payload
p = []
# 0
p.append(
)

if local == True:
	r = process(elf)
	if enable_gdb == True:
		gdb.attach(r)
else:
	r = remote(host, port)

while r.can_recv() == True:
	print r.recvline()

for i in range(len(p)):
	wait(local, 'waiting p[' + str(i) + ']')
	r.sendline(p[i])
	while r.can_recv() == True:
		print r.recvline()

r.interactive()
