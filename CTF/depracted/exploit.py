#!/usr/bin/python2

from pwn import *
# state constants
LOCAL_PROC = 0x00
LOCAL_NCAT = 0x01
REMOTE = 0x10

# running configs
state = 
#local = False
enable_gdb = False
#enable_gdb = True
elf = ''
host = 'ctf.adl.csie.ncu.edu.tw'
port = 10135

def boot():
	if local == True:
		r = process(elf)
		if enable_gdb == True:
			gdb.attach(r)
	else:
		r = remote(host, port)
	return r

def wait(isLocal = local, msg = 'pause', stime = 0.2):
	if isLocal == True:
		raw_input(msg)
	else:
		time.sleep(stime)

# var for exploit															   
stack = 0
code = 0
libc = 0

# plt & got
plt = 0
got = 0
# main
main = 0
# rop gadgets

# lib offsets
if local == True:
	l = ELF('./libc.so.6.l')
else:
	l = ELF('./libc.so.6.r')
libc_base = 0
# code offsets
code_base = 0
# plt, got
got = 0	 # <_GLOBAL_OFFSET_TABLE_> offset

r = boot()

payload = ''
payload += ''

r.interactive()
